---
title: "commonnames"
author: "Jules Stacy"
date: "February 13, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r echo=FALSE}
suppressPackageStartupMessages(library(shiny))
suppressPackageStartupMessages(library(tidyverse))


#data data data data data data data data data data data data data data data data data data data data 
#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

beer_df = read.csv("./Data/Beers.csv")

breweries_df = read.csv("./Data/Breweries.csv")

#data cleaning
colnames(breweries_df) <- c("Brewery_id", "Brewery", "City", "State")
breweries_df$State <- str_replace_all(breweries_df$State, " ", "")

#dataset merge
beer_df = merge(beer_df, breweries_df, by="Brewery_id")

#duplicate beers were found, cleaning
beer_df <- beer_df %>% distinct(Name, ABV, IBU, Style, Ounces, .keep_all=TRUE)

#removal of NA values
beer_df = beer_df %>% filter(!is.na(ABV))

mbeer <- beer_df %>% distinct(Name, ABV, IBU, Style, Ounces, .keep_all=TRUE)
invisible(mbeer <- mbeer[!duplicated(mbeer$Name),])

x=c()
for(i in 1:length(mbeer$Name)){
  invisible(x <- paste(x, mbeer[i,2]))
}

invisible(name_words <- str_split(x, "( )"))
invisible(gsub(" ", "", name_words))
invisible(names_table <- sort(table(name_words), decreasing=T))
invisible(names_table <- names_table[-58])
invisible(namewords_great10 <- names_table[1:76])
invisible(topwords <- as.data.frame(namewords_great10))
wordcount <- as.data.frame.matrix(topwords)

ui <- fluidPage(
  
  # App title ----
  titlePanel("Histogram of Common Names of Beers"),
  br(),

  # Sidebar layout with input and output definitions ----
  sidebarLayout(
    
    # Sidebar panel for inputs ----
    sidebarPanel(
      
      # Input: Specification of range within an interval ----
      sliderInput("range", "Word Prevalences:",
                  min = 10, max = 569,
                  value = c(50,225)),

      # br() element to introduce extra vertical spacing ----
      br(),
      
    ),# end sidebarPanel
    
    # Main panel for displaying outputs ----
    mainPanel(
      
      # Output: Histogram ----
      plotOutput( "plot")
      
    ) ) ) # end main, sidebarLayout, fluid page

# Define server logic required to draw a histogram ----
server <- function(input, output) {
  

  # This expression that generates a histogram is wrapped in a call
  # to renderPlot to indicate that:
  #
  # 1. It is "reactive" and therefore should be automatically
  #    re-executed when inputs (input$bins) change
  # 2. Its output type is a plot
  output$plot <- renderPlot({
    tempcount <- wordcount %>% filter(Freq<= max(input$range) & Freq >= min(input$range))
        x    <- tempcount$Freq
    barplot(x,  col = "#75AADB", border = "white",
          main = "Most Common Words in Beer Names",
          names=tempcount$name_words, las=2)

      
 
  })
  
}

shinyApp(ui, server)



```